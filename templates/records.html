<script src="../static/less-1.3.0.min.js"></script>
<script src="../static/jquery-1.7.2.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.min.js" type="text/javascript"></script>
<script src="http://malsup.github.com/jquery.form.js"></script> 
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.0/themes/ui-lightness/jquery-ui.css" />
<link rel="stylesheet" type="text/css" href="../static/rcrd-styles.css">
<script src="../static/bootstrap/js/bootstrap.min.js"></script>

<div class="container">
<div class="page-header">
  <h1>RcrdKeepr <small class ="mgmt">Vinyl Management powered by <img width="75" height="28" src='http://developer.rdio.com/files/RdioBlueLogo.png'></img></small></h1>
</div>
    <body>
        <div class="messages"></div>
        <div class="row">
            <center>
                <form class="new_record form-inline" action="/submit" method="post" role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" id="artist" name="artist" placeholder="Enter Artist Name">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="album" name="album" placeholder="Enter Album Name">
                    </div>
                    <button type="submit" class="sub btn btn-default">Add Record</button>
                </form>
            </center>
        </div>
        <div class="albums row">
            {% for s in selection %}
            <div class="col-md-3">
                <div class="delete-wrap" id="{{ s['id'] }}">
                    <a href="#" class="delete">
                        <span id="delete_logo" class="glyphicon glyphicon-remove"></span>
                    </a>
                </div>
                {{ s['artist'] }} - {{ s['album'] }}
                <img class="get_details" id="{{ s['id'] }}" src="{{ s['album art'] }}" width="200" height="200"></img>
                <a data-toggle="modal" href="#editModal{{ s['id'] }}">
                <span class="glyphicon glyphicon-pencil"></span>
                </a>
            </div>
                {% include 'modals.html' %}
            {% endfor %}
        </div>

    </body>
</div>

<script>

$('.sub').click(function(e){
    e.preventDefault()
    $('.new_record').ajaxSubmit({
        success: function(r){
            console.log(r)
            $('.albums').append(r)
            $('.messages').addClass('alert alert-success alert-dismissable')
            $('.messages').append('<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>Record Successfully Added')
        },
        error: function(e){
            console.log(e)
        }
    })
})

$('.get_details').dblclick(function(){
    var id = $(this).attr('id')
    console.log(id)
    $('#infoModal' + id).modal('show')
})

$('.save_edit').click(function(e){
    e.preventDefault()
    $(this).parents('.edit_record').ajaxSubmit({
        success: function(r){
            console.log(r)
        },
        error: function(e){
            console.log(e)
        }
    })
})

$('.delete').click(function(){
    var conf = confirm('Are you sure you want to delete?')
    if (conf == true){
        var record_id = $(this).parents('div:first').attr('id')
        $(this).parents('div').parents('div:first').remove()
        $.ajax({
            url: '/delete/' + record_id,
            type: 'post'
        })
    }
    else {
        console.log('dont delete')
    }
})

</script>